---
import Layout from "@layouts/Layout.astro";
import { NextMoviesList } from "@components/MoviesList";
import { getNextUserMovies } from "lib/turso";

const { next } = Astro.params;

const nextAnonymousMovies = (await getNextUserMovies())
  .slice(0, Number(next))
  .map((movie) => ({ ...movie, status: "UNKNOWN", visible: true })); // default movies without user (anonymous)
---

<Layout title="Top Next" backButton={true} section="Next">
  <div class="container mx-auto">
    <div class="flex justify-between">
      <h2
        class="uppercase tracking-wider text-red-600 text-xl font-semibold pb-4"
      >
        <span class="text-white">
          <!-- TODO: FUTURE FILTERS -->
        </span>
      </h2>
      <h6 class="tracking-wider text-white font-semibold pb-4">
        Next <span class="text-red-600">{next}</span>
      </h6>
    </div>
    <NextMoviesList
      client:visible
      initialNextMovies={nextAnonymousMovies}
      next={Number(next)}
    />
  </div>
</Layout>
