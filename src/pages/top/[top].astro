---
import Layout from "@layouts/Layout.astro";
import MovieFilters from "@components/MovieFilters";
import "react-responsive-carousel/lib/styles/carousel.min.css";
import { MoviesList } from "@components/MoviesList";
import { getNextUserMovies } from "lib/turso";

const { top } = Astro.params;

const topMovies = (await getNextUserMovies())
  .slice(0, Number(top))
  .map((movie) => ({ ...movie, status: "UNKNOWN", visible: true })); // default movies without user (anonymous)
---

<Layout title="Top Pelis" backButton={true}>
  <div class="container mx-auto px-4 py-4">
    <div class="flex justify-between">
      <h2
        class="uppercase tracking-wider text-red-600 text-xl font-semibold pb-4"
      >
        Top <span class="text-white">{top}</span>
      </h2>
      <div class="pb-4">
        <MovieFilters client:visible />
      </div>
    </div>
    <MoviesList client:visible initialMovies={topMovies} />
  </div>
</Layout>
