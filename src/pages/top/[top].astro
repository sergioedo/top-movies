---
import Layout from "@layouts/Layout.astro";
import { FiltrableMovieCard } from "@components/MovieCard";
import MovieFilters from "@components/MovieFilters";
import "react-responsive-carousel/lib/styles/carousel.min.css";
import { Carousel } from "react-responsive-carousel";
import MoviesCarrousel from "@components/MoviesCarrousel";
import { getNextUserMovies } from "lib/turso";

const { top } = Astro.params;

const topMovies = (await getNextUserMovies()).slice(0, Number(top)); // default movies without user (anonymous)
---

<Layout title="Top Pelis" backButton={false}>
  <div class="container mx-auto px-4 py-8">
    <div class="flex justify-between">
      <h2
        class="uppercase tracking-wider text-red-600 text-xl font-semibold py-4"
      >
        Top <span class="text-white">{top}</span>
      </h2>
      <MovieFilters client:load />
    </div>
    <!-- Desktop -->
    <div class="hidden md:block">
      <div
        class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-8"
      >
        {
          topMovies.map((movie) => (
            <FiltrableMovieCard
              client:visible
              initialMovie={{ ...movie, status: "UNKNOWN", visible: true }}
            />
          ))
        }
      </div>
    </div>
    <!-- Mobile -->
    <div class="block md:hidden">
      <div class="mt-4 mb-8 bg-slate-800 rounded-lg">
        <MoviesCarrousel client:load initialMovies={topMovies} />
      </div>
    </div>
  </div>
</Layout>
